<!DOCTYPE html>
<html lang="en-US">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>位运算简介及实用技巧（一）：基础篇 | Matrix67: The Aha Moments</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://www.matrix67.com/blog/xmlrpc.php">
	<script src="http://www.matrix67.com/blog/wp-content/themes/matrix67/js/jquery-2.1.0.min.js"></script>
	<script src="http://www.matrix67.com/blog/wp-content/themes/matrix67/js/old-theme.js"
		type="text/javascript"></script>
	<link rel="stylesheet" href="http://www.matrix67.com/blog/wp-content/themes/matrix67/css/old-theme.css"
		type="text/css" media="all">
	<link rel='dns-prefetch' href='//s.w.org' />
	<link rel="alternate" type="application/rss+xml" title="Matrix67: The Aha Moments &raquo; Feed"
		href="http://www.matrix67.com/blog/feed" />
	<link rel="alternate" type="application/rss+xml" title="Matrix67: The Aha Moments &raquo; Comments Feed"
		href="http://www.matrix67.com/blog/comments/feed" />
	<link rel="alternate" type="application/rss+xml"
		title="Matrix67: The Aha Moments &raquo; 位运算简介及实用技巧（一）：基础篇 Comments Feed"
		href="http://www.matrix67.com/blog/archives/263/feed" />
	<script type="text/javascript">
		window._wpemojiSettings = { "baseUrl": "https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/", "ext": ".png", "svgUrl": "https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/", "svgExt": ".svg", "source": { "concatemoji": "http:\/\/www.matrix67.com\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.23" } };
		!function (e, o, t) { var a, n, r; function i(e) { var t = o.createElement("script"); t.src = e, t.type = "text/javascript", o.getElementsByTagName("head")[0].appendChild(t) } for (r = Array("simple", "flag", "unicode8", "diversity", "unicode9"), t.supports = { everything: !0, everythingExceptFlag: !0 }, n = 0; n < r.length; n++)t.supports[r[n]] = function (e) { var t, a, n = o.createElement("canvas"), r = n.getContext && n.getContext("2d"), i = String.fromCharCode; if (!r || !r.fillText) return !1; switch (r.textBaseline = "top", r.font = "600 32px Arial", e) { case "flag": return (r.fillText(i(55356, 56806, 55356, 56826), 0, 0), n.toDataURL().length < 3e3) ? !1 : (r.clearRect(0, 0, n.width, n.height), r.fillText(i(55356, 57331, 65039, 8205, 55356, 57096), 0, 0), a = n.toDataURL(), r.clearRect(0, 0, n.width, n.height), r.fillText(i(55356, 57331, 55356, 57096), 0, 0), a !== n.toDataURL()); case "diversity": return r.fillText(i(55356, 57221), 0, 0), a = (t = r.getImageData(16, 16, 1, 1).data)[0] + "," + t[1] + "," + t[2] + "," + t[3], r.fillText(i(55356, 57221, 55356, 57343), 0, 0), a != (t = r.getImageData(16, 16, 1, 1).data)[0] + "," + t[1] + "," + t[2] + "," + t[3]; case "simple": return r.fillText(i(55357, 56835), 0, 0), 0 !== r.getImageData(16, 16, 1, 1).data[0]; case "unicode8": return r.fillText(i(55356, 57135), 0, 0), 0 !== r.getImageData(16, 16, 1, 1).data[0]; case "unicode9": return r.fillText(i(55358, 56631), 0, 0), 0 !== r.getImageData(16, 16, 1, 1).data[0] }return !1 }(r[n]), t.supports.everything = t.supports.everything && t.supports[r[n]], "flag" !== r[n] && (t.supports.everythingExceptFlag = t.supports.everythingExceptFlag && t.supports[r[n]]); t.supports.everythingExceptFlag = t.supports.everythingExceptFlag && !t.supports.flag, t.DOMReady = !1, t.readyCallback = function () { t.DOMReady = !0 }, t.supports.everything || (a = function () { t.readyCallback() }, o.addEventListener ? (o.addEventListener("DOMContentLoaded", a, !1), e.addEventListener("load", a, !1)) : (e.attachEvent("onload", a), o.attachEvent("onreadystatechange", function () { "complete" === o.readyState && t.readyCallback() })), (a = t.source || {}).concatemoji ? i(a.concatemoji) : a.wpemoji && a.twemoji && (i(a.twemoji), i(a.wpemoji))) }(window, document, window._wpemojiSettings);
	</script>
	<style type="text/css">
		img.wp-smiley,
		img.emoji {
			display: inline !important;
			border: none !important;
			box-shadow: none !important;
			height: 1em !important;
			width: 1em !important;
			margin: 0 .07em !important;
			vertical-align: -0.1em !important;
			background: none !important;
			padding: 0 !important;
		}
	</style>
	<link rel='stylesheet' id='matrix67-style-css'
		href='http://www.matrix67.com/blog/wp-content/themes/matrix67/style.css?ver=4.6.23' type='text/css'
		media='all' />
	<link rel='https://api.w.org/' href='http://www.matrix67.com/blog/wp-json/' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.matrix67.com/blog/xmlrpc.php?rsd" />
	<link rel="wlwmanifest" type="application/wlwmanifest+xml"
		href="http://www.matrix67.com/blog/wp-includes/wlwmanifest.xml" />
	<link rel='prev' title='Yuor bairn is samtrer tahn you tnhik' href='http://www.matrix67.com/blog/archives/260' />
	<link rel='next' title='位运算简介及实用技巧（二）：进阶篇(1)' href='http://www.matrix67.com/blog/archives/264' />
	<meta name="generator" content="WordPress 4.6.23" />
	<link rel="canonical" href="http://www.matrix67.com/blog/archives/263" />
	<link rel='shortlink' href='http://www.matrix67.com/blog/?p=263' />
	<link rel="alternate" type="application/json+oembed"
		href="http://www.matrix67.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.matrix67.com%2Fblog%2Farchives%2F263" />
	<link rel="alternate" type="text/xml+oembed"
		href="http://www.matrix67.com/blog/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.matrix67.com%2Fblog%2Farchives%2F263&#038;format=xml" />
</head>

<body class="single single-post postid-263 single-format-standard">
	<div id="page" class="hfeed site">

		<header id="masthead" class="site-header" role="banner">
			<div class="site-branding">
				<h1 class="site-title"><a href="http://www.matrix67.com/blog/" rel="home">Matrix67: The Aha Moments</a>
				</h1>
			</div>
			<aside id="search" class="widget_search">
				<form role="search" method="get" class="search-form" action="http://www.matrix67.com/blog/">
					<label>
						<span class="screen-reader-text"></span>
						<input type="search" class="search-field" value="" name="s" title="" />
					</label>
					<input type="submit" class="search-submit" value="&#59393;" />
				</form>
			</aside>
		</header><!-- #masthead -->

		<div id="content" class="site-content">

			<div id="primary" class="content-area">
				<main id="main" class="site-main" role="main">



					<aside id="notice">这是一篇旧文，点击<a id="theme-toggle">此处</a>以旧主题模式浏览。</aside>
					<article id="post-263"
						class="post-263 post type-post status-publish format-standard hentry category-uncategorized tag-c tag-pascal tag-405 tag-409 tag-412 tag-356">
						<header class="entry-header">
							<h1 class="entry-title">位运算简介及实用技巧（一）：基础篇</h1>
						</header><!-- .entry-header -->

						<div class="entry-content">
							<p>&nbsp;&nbsp;&nbsp;&nbsp;去年年底写的关于<a target="_blank"
									href="http://www.matrix67.com/blog/article.asp?id=153">位运算</a>的日志是这个Blog里少数大受欢迎的文章之一，很多人都希望我能不断完善那篇文章。后来我看到了不少其它的资料，学习到了更多关于位运算的知识，有了重新整理位运算技巧的想法。从今天起我就开始写这一系列位运算讲解文章，与其说是原来那篇文章的follow-up，不如说是一个remake。当然首先我还是从最基础的东西说起。
							</p>
							<p><strong>什么是位运算？</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;程序中的所有数在计算机内存中都是以二进制的形式储存的。位运算说穿了，就是直接对整数在内存中的二进制位进行操作。比如，and运算本来是一个逻辑运算符，但整数与整数之间也可以进行and运算。举个例子，6的二进制是110，11的二进制是1011，那么6
								and 11的结果就是2，它是二进制对应位进行逻辑运算的结果（0表示False，1表示True，空位都当0处理）：<br /><span
									style="font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; 110<br />AND
									1011<br />&#8212;&#8212;&#8212;-<br />&nbsp;&nbsp;&nbsp;&nbsp;0010&nbsp;&nbsp;&#8211;&gt;&nbsp;&nbsp;2</span><br />&nbsp;&nbsp;&nbsp;&nbsp;由于位运算直接对内存数据进行操作，不需要转成十进制，因此处理速度非常快。当然有人会说，这个快了有什么用，计算6
								and 11没有什么实际意义啊。这一系列的文章就将告诉你，位运算到底可以干什么，有些什么经典应用，以及如何用位运算优化你的程序。</p>
							<p><strong>Pascal和C中的位运算符号</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;下面的a和b都是整数类型，则：<br /><span
									style="font-family:宋体">C语言&nbsp;&nbsp;|&nbsp;&nbsp;Pascal语言<br />&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;-<br />a
									&amp; b&nbsp;&nbsp;|&nbsp;&nbsp;a and b<br />a | b&nbsp;&nbsp;|&nbsp;&nbsp;a o&#114;
									b<br />a ^ b&nbsp;&nbsp;|&nbsp;&nbsp;a xor b<br />&nbsp;&nbsp;~a&nbsp;&nbsp;
									|&nbsp;&nbsp; not a<br />a &lt;&lt; b |&nbsp;&nbsp;a shl b<br />a &gt;&gt; b
									|&nbsp;&nbsp;a shr
									b</span><br />&nbsp;&nbsp;&nbsp;&nbsp;注意C中的逻辑运算和位运算符号是不同的。520|1314=1834，但520||1314=1，因为逻辑运算时520和1314都相当于True。同样的，!a和~a也是有区别的。
							</p>
							<p><strong>各种位运算的使用</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;=== 1. and运算
								===<br />&nbsp;&nbsp;&nbsp;&nbsp;and运算通常用于二进制取位操作，例如一个数 and
								1的结果就是取二进制的最末位。这可以用来判断一个整数的奇偶，二进制的最末位为0表示该数为偶数，最末位为1表示该数为奇数.</p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;=== 2. o&#114;运算
								===<br />&nbsp;&nbsp;&nbsp;&nbsp;o&#114;运算通常用于二进制特定位上的无条件赋值，例如一个数or
								1的结果就是把二进制最末位强行变成1。如果需要把二进制最末位变成0，对这个数or 1之后再减一就可以了，其实际意义就是把这个数强行变成最接近的偶数。</p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;=== 3. xor运算
								===<br />&nbsp;&nbsp;&nbsp;&nbsp;xor运算通常用于对二进制的特定一位进行取反操作，因为异或可以这样定义：0和1异或0都不变，异或1则取反。<br />&nbsp;&nbsp;&nbsp;&nbsp;xor运算的逆运算是它本身，也就是说两次异或同一个数最后结果不变，即(a
								xor b) xor b = a。xor运算可以用于简单的加密，比如我想对我MM说1314520，但怕别人知道，于是双方约定拿我的生日19880516作为密钥。1314520
								xor 19880516 = 20665500，我就把20665500告诉MM。MM再次计算20665500 xor
								19880516的值，得到1314520，于是她就明白了我的企图。<br />&nbsp;&nbsp;&nbsp;&nbsp;下面我们看另外一个东西。定义两个符号#和@（我怎么找不到那个圈里有个叉的字符），这两个符号互为逆运算，也就是说(x
								# y) @ y =
								x。现在依次执行下面三条命令，结果是什么？<br /><code>x &lt;- x # y<br />y &lt;- x @ y<br />x &lt;- x @ y</code><br />&nbsp;&nbsp;&nbsp;&nbsp;执行了第一句后x变成了x
								# y。那么第二句实质就是y &lt;- x # y @ y，由于#和@互为逆运算，那么此时的y变成了原来的x。第三句中x实际上被赋值为(x # y) @
								x，如果#运算具有交换律，那么赋值后x就变成最初的y了。这三句话的结果是，x和y的位置互换了。<br />&nbsp;&nbsp;&nbsp;&nbsp;加法和减法互为逆运算，并且加法满足交换律。把#换成+，把@换成-，我们可以写出一个不需要临时变量的swap过程(Pascal)。<br /><code>procedure swap(var a,b:longint);<br />begin<br />&nbsp;&nbsp; a:=a + b;<br />&nbsp;&nbsp; b:=a - b;<br />&nbsp;&nbsp; a:=a - b;<br />end;</code><br />&nbsp;&nbsp;&nbsp;&nbsp;好了，刚才不是说xor的逆运算是它本身吗？于是我们就有了一个看起来非常诡异的swap过程：<br /><code>procedure swap(var a,b:longint);<br />begin<br />&nbsp;&nbsp; a:=a xor b;<br />&nbsp;&nbsp; b:=a xor b;<br />&nbsp;&nbsp; a:=a xor b;<br />end;</code>
							</p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;=== 4. not运算
								===<br />&nbsp;&nbsp;&nbsp;&nbsp;not运算的定义是把内存中的0和1全部取反。使用not运算时要格外小心，你需要注意整数类型有没有符号。如果not的对象是无符号整数（不能表示负数），那么得到的值就是它与该类型上界的差，因为无符号类型的数是用$0000到$FFFF依次表示的。下面的两个程序（仅语言不同）均返回65435。<br /><code>var<br />&nbsp;&nbsp; a:word;<br />begin<br />&nbsp;&nbsp; a:=100;<br />&nbsp;&nbsp; a:=not a;<br />&nbsp;&nbsp; writeln(a);<br />end.</code><br /><code>#include &lt;stdio.h&gt;<br />int main()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;unsigned short a=100;<br />&nbsp;&nbsp;&nbsp;&nbsp;a = ~a;<br />&nbsp;&nbsp;&nbsp;&nbsp;printf( &#34;%dn&#34;, a );&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br />}</code><br />&nbsp;&nbsp;&nbsp;&nbsp;如果not的对象是有符号的整数，情况就不一样了，稍后我们会在“整数类型的储存”小节中提到。
							</p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;=== 5. shl运算 ===<br />&nbsp;&nbsp;&nbsp;&nbsp;a shl
								b就表示把a转为二进制后左移b位（在后面添b个0）。例如100的二进制为1100100，而110010000转成十进制是400，那么100 shl 2 = 400。可以看出，a
								shl b的值实际上就是a乘以2的b次方，因为在二进制数后添一个0就相当于该数乘以2。<br />&nbsp;&nbsp;&nbsp;&nbsp;通常认为a shl 1比a *
								2更快，因为前者是更底层一些的操作。因此程序中乘以2的操作请尽量用左移一位来代替。<br />&nbsp;&nbsp;&nbsp;&nbsp;定义一些常量可能会用到shl运算。你可以方便地用1
								shl 16 &#8211; 1来表示65535。很多算法和数据结构要求数据规模必须是2的幂，此时可以用shl来定义Max_N等常量。</p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;=== 6. shr运算 ===<br />&nbsp;&nbsp;&nbsp;&nbsp;和shl相似，a shr
								b表示二进制右移b位（去掉末b位），相当于a除以2的b次方（取整）。我们也经常用shr 1来代替div
								2，比如二分查找、堆的插入操作等等。想办法用shr代替除法运算可以使程序效率大大提高。最大公约数的二进制算法用除以2操作来代替慢得出奇的mod运算，效率可以提高60%。</p>
							<p><strong>位运算的简单应用</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;有时我们的程序需要一个规模不大的Hash表来记录状态。比如，做数独时我们需要27个Hash表来统计每一行、每一列和每一个小九宫格里已经有哪些数了。此时，我们可以用27个小于2^9的整数进行记录。例如，一个只填了2和5的小九宫格就用数字18表示（二进制为000010010），而某一行的状态为511则表示这一行已经填满。需要改变状态时我们不需要把这个数转成二进制修改后再转回去，而是直接进行位操作。在搜索时，把状态表示成整数可以更好地进行判重等操作。<a
									target="_blank" href="http://www.vijos.cn/Problem_Sho
w.asp?id=1197">这道题</a>是在搜索中使用位运算加速的经典例子。以后我们会看到更多的例子。<br />&nbsp;&nbsp;&nbsp;&nbsp;下面列举了一些常见的二进制位的变换操作。</p>
							<p><span style="font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp;功能&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									示例&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;位运算<br />&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;<br />去掉最后一位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(101101-&gt;10110)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | x
									shr 1<br />在最后加一个0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(101101-&gt;1011010)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | x shl
									1<br />在最后加一个1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(101101-&gt;1011011)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | x shl
									1+1<br />把最后一位变成1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(101100-&gt;101101)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x
									o&#114; 1<br />把最后一位变成0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(101101-&gt;101100)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x
									o&#114; 1-1<br />最后一位取反&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(101101-&gt;101100)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x
									xor 1<br />把右数第k位变成1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(101001-&gt;101101,k=3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x o&#114; (1 shl
									(k-1))<br />把右数第k位变成0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(101101-&gt;101001,k=3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x and not (1 shl
									(k-1))<br />右数第k位取反&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(101001-&gt;101101,k=3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x xor (1 shl
									(k-1))<br />取末三位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(1101101-&gt;101)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									x and
									7<br />取末k位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									| (1101101-&gt;1101,k=5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | x and (1 shl
									k-1)<br />取右数第k位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(1101101-&gt;1,k=4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x
									shr (k-1) and
									1<br />把末k位变成1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
									(101001-&gt;101111,k=4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x o&#114; (1 shl
									k-1)<br />末k位取反&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									| (101001-&gt;100110,k=4)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x xor (1 shl
									k-1)<br />把右边连续的1变成0&nbsp;&nbsp;&nbsp;&nbsp;|
									(100101111-&gt;100100000)&nbsp;&nbsp;&nbsp;&nbsp;| x and
									(x+1)<br />把右起第一个0变成1&nbsp;&nbsp;&nbsp;&nbsp;|
									(100101111-&gt;100111111)&nbsp;&nbsp;&nbsp;&nbsp;| x o&#114;
									(x+1)<br />把右边连续的0变成1&nbsp;&nbsp;&nbsp;&nbsp;|
									(11011000-&gt;11011111)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| x o&#114;
									(x-1)<br />取右边连续的1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
									(100101111-&gt;1111)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | (x xor (x+1))
									shr 1<br />去掉右起第一个1的左边 |
									(100101000-&gt;1000)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | x and (x xor
									(x-1))</span></p>
							<p>&nbsp;&nbsp;&nbsp;&nbsp;最后这一个在树状数组中会用到。</p>
							<p><strong>Pascal和C中的16进制表示</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;Pascal中需要在16进制数前加$符号表示，C中需要在前面加0x来表示。这个以后我们会经常用到。
							</p>
							<p><strong>整数类型的储存</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;我们前面所说的位运算都没有涉及负数，都假设这些运算是在unsigned/word类型（只能表示正数的整型）上进行操作。但计算机如何处理有正负符号的整数类型呢？下面两个程序都是考察16位整数的储存方式（只是语言不同）。<br /><code>var<br />&nbsp;&nbsp; a,b:integer;<br />begin<br />&nbsp;&nbsp; a:=$0000;<br />&nbsp;&nbsp; b:=$0001;<br />&nbsp;&nbsp; write(a,&#39; &#39;,b,&#39; &#39;);<br />&nbsp;&nbsp; a:=$FFFE;<br />&nbsp;&nbsp; b:=$FFFF;<br />&nbsp;&nbsp; write(a,&#39; &#39;,b,&#39; &#39;);<br />&nbsp;&nbsp; a:=$7FFF;<br />&nbsp;&nbsp; b:=$8000;<br />&nbsp;&nbsp; writeln(a,&#39; &#39;,b);<br />end.</code><br /><code>#include &lt;stdio.h&gt;<br />int main()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;short int a, b;<br />&nbsp;&nbsp;&nbsp;&nbsp;a = 0x0000;<br />&nbsp;&nbsp;&nbsp;&nbsp;b = 0x0001;<br />&nbsp;&nbsp;&nbsp;&nbsp;printf( &#34;%d %d &#34;, a, b );<br />&nbsp;&nbsp;&nbsp;&nbsp;a = 0xFFFE;<br />&nbsp;&nbsp;&nbsp;&nbsp;b = 0xFFFF;<br />&nbsp;&nbsp;&nbsp;&nbsp;printf( &#34;%d %d &#34;, a, b );<br />&nbsp;&nbsp;&nbsp;&nbsp;a = 0x7FFF;<br />&nbsp;&nbsp;&nbsp;&nbsp;b = 0x8000;<br />&nbsp;&nbsp;&nbsp;&nbsp;printf( &#34;%d %dn&#34;, a, b );<br />&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br />}</code><br />&nbsp;&nbsp;&nbsp;&nbsp;两个程序的输出均为0
								1 -2 -1 32767
								-32768。其中前两个数是内存值最小的时候，中间两个数则是内存值最大的时候，最后输出的两个数是正数与负数的分界处。由此你可以清楚地看到计算机是如何储存一个整数的：计算机用$0000到$7FFF依次表示0到32767的数，剩下的$8000到$FFFF依次表示-32768到-1的数。32位有符号整数的储存方式也是类似的。稍加注意你会发现，二进制的第一位是用来表示正负号的，0表示正，1表示负。这里有一个问题：0本来既不是正数，也不是负数，但它占用了$0000的位置，因此有符号的整数类型范围中正数个数比负数少一个。对一个有符号的数进行not运算后，最高位的变化将导致正负颠倒，并且数的绝对值会差1。也就是说，not
								a实际上等于-a-1。这种整数储存方式叫做“补码”。</p>
							<p><strong>最后还有两句话</strong><br />&nbsp;&nbsp;&nbsp;&nbsp;Matrix67原创<br />&nbsp;&nbsp;&nbsp;&nbsp;转贴请注明出处
							</p>
						</div><!-- .entry-content -->

						<footer class="entry-footer">
							<div class="entry-meta">
								<span class="posted-on"><a href="http://www.matrix67.com/blog/archives/263"
										rel="bookmark"><time class="entry-date published"
											datetime="2007-07-23T04:39:08+00:00">2007 年 7 月 23 日</time></a></span> / <a
									href="http://www.matrix67.com/blog/archives/tag/c%e8%af%ad%e8%a8%80"
									rel="tag">C语言</a>, <a
									href="http://www.matrix67.com/blog/archives/tag/pascal%e8%af%ad%e8%a8%80"
									rel="tag">Pascal语言</a>, <a
									href="http://www.matrix67.com/blog/archives/tag/%e4%ba%8c%e8%bf%9b%e5%88%b6"
									rel="tag">二进制</a>, <a
									href="http://www.matrix67.com/blog/archives/tag/%e4%bb%a3%e7%a0%81"
									rel="tag">代码</a>, <a
									href="http://www.matrix67.com/blog/archives/tag/%e4%bd%8d%e8%bf%90%e7%ae%97"
									rel="tag">位运算</a>, <a
									href="http://www.matrix67.com/blog/archives/tag/%e5%af%86%e7%a0%81" rel="tag">密码</a>
							</div><!-- .entry-meta -->

						</footer><!-- .entry-footer -->
					</article><!-- #post-## -->
					<div id="rss"><a href="http://www.matrix67.com/blog/feed" target="_blank">&#59392;</a></div>
					<!--php matrix67_post_nav(); -->
				</main><!-- #main -->
			</div><!-- #primary -->

			<div id="secondary" class="widget-area" role="complementary">

			</div><!-- #secondary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info">
				Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a>
				<span class="sep"> | </span>
				Designed by <a href="http://localhost-8080.com" rel="designer" target="_blank">♥ Localhost</a>
				<span class="sep"> | </span>
				Creative Commons <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh_TW"
					target="_blank">BY-NC-SA</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<div style="display:none">
		<script src="http://s44.cnzz.com/stat.php?id=349609&amp;web_id=349609&amp;show=pic" language="JavaScript"
			charset="gb2312" type="text/javascript">
			</script>
	</div>
	<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
	</script>
	<script type="text/javascript">
		_uacct = "UA-1093817-1";
		urchinTracker();
	</script>

	<script type='text/javascript'
		src='http://www.matrix67.com/blog/wp-content/plugins/akismet/_inc/form.js?ver=3.1.11'></script>
	<script type='text/javascript'
		src='http://www.matrix67.com/blog/wp-content/themes/matrix67/js/navigation.js?ver=20120206'></script>
	<script type='text/javascript'
		src='http://www.matrix67.com/blog/wp-content/themes/matrix67/js/skip-link-focus-fix.js?ver=20130115'></script>
	<script type='text/javascript'
		src='http://www.matrix67.com/blog/wp-includes/js/comment-reply.min.js?ver=4.6.23'></script>
	<script type='text/javascript'
		src='http://www.matrix67.com/blog/wp-includes/js/wp-embed.min.js?ver=4.6.23'></script>

</body>

</html>
<!-- Dynamic page generated in 0.250 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2022-06-17 21:30:30 -->

<!-- super cache -->